 - 어제 디버그 스피어 만들었고 오늘은 스카이박스. 스카이박스는 컴포넌트로 취급할겁니다.

 - CSkyBox 클래스는 렌더컴포넌트를 상속합니다.
   그렇다는 것은 메쉬와 머터리얼을 세팅할수 있다는 말이죠

   컴포넌트니까 finaltick() 무조건 구현해줘야하구요

   enum class로 스카이박스의 타입을 2가지로 정의해둘게요. sphere 와 box

   그리고 컴포넌트 추가했으니 게임오브젝트에 Get 매크로와 컴포넌트의 Get매크로 추가.

   component.h 파일에 CSkyBox.h를 인클루드

   CLONE 복사생성자 매크로 추가

   렌더컴포넌트를 상속했기 때문에 UpdateData()와 render()도 무조건 구현해야하죠 안하면 디버그 오류.

 - 레벨에 스카이박스 오브젝트 생성.
 - 광원설정은 다시 디렉셔널로 바꿀게요.

 - SetSkyBoxType()함수
  - 인자로준 Type에 따라 if문으로
    SetMesh() 호출해서 타입에 맞는 메쉬로 세팅한다.
   - 스카이박스는 이렇게 타입지정하면 자동으로 메쉬가 설정됩니다.
     메쉬렌더는 다양한 메쉬를 세팅하게 놔두지만 타일맵이나 파티클시스템이나 스카이박스는 미리 메쉬를 정해놓기 때문에 외부에서 따로 설정할 필요가 없는거죠

 - 쉐이더 파일 만들때마다"쉐이더형식" "쉐이더모델"을 각각 fx와 5.0 으로 설정해주는 모습이 계속 보인다.
 - skybox.fx 파일
  - 스카이박스용 쉐이더 파일.

 &&쉐이더에서 설정한 VS_IN VS_OUT과 내 c++ 파일과 어떻게 연동하는 걸까?
  - CAssetMgr_init.cpp 에서 주석으로 SkyBoxShader 보세요.
  - 아 그리고 포폴할떄 쉐이더 도메인 설정 잘못해서 문제 생기는 학생들 정말 많이 봤으요 DOMAIN_TRANSPARENT 가 제일 마지막에 그려지죠? 정확하게 구조 다시 파악해보세요
  
 - SKyBoxShader, CAsset_Init.cpp
  - 스카이 박스는 뭔가 물체가 그려지면 스카이박스는 그려지면 안됩니다. 더 가까이 있는 물체가 그려졌으면 더 멀리있는 스카이 박스가 그려지면 안되죠?
    그러니까 깊이스텐실 설정 해줘야 하구요. NDC좌표계에서 범위가 0~1이었죠? 1이 가장 멀리 있는 건데 스카이박스는 1이되야갰죠?

    DS_TYPE은 지금까지 한번도 안쓴 LESS_EQUAL로 할게요.
    LESS 옵션을 써버리면 안되는 이유는, 원래 깊이스텐실 텍스처가 자동으로 값이 1로 초기화된다고 했죠?
    그런데 나도 스카이박스의 깊이를 1로설정한단 말이죠? 그러면 LESS 설정 해버리면 스카이박스 본인의 갚이스텐실 "1"이 다른 깊이스텐실보다 작을떼만 그려지기 떄문에
    깊이스텐실 텍스처가 똑같은 1 이기 때문에 스카이 박스가 안그려집니다. 
    
    즉 남들보다 1보다 작을때만 그리세요가 less가 되고, 남들보다 1보다 같거나 작을때만 그리세요가 less equal입니다.
    스카이박스 깊이를 가장 먼 1로 두고싶다 + 기본깊이스텐실 텍스처의 깊이값이 1로 똑같다 라는 조건이 합쳐져서
    그래서 스카이박스의 깊이타입을 LESS_EQUAL로 설정하는겁니다.

 - (Skybox 머터리얼도 만드심)


 %% AssetMgr 에서 쉐이더와 머터리얼 만드시고나서 픽셀 쉐이더에서 이것저것하셨다.
    정말 VS_IN VS_OUT 이런 애들은 에셋매니저에서 쉐이더와 머터리얼을 만들면 변수연결 되나본데?

  
 - render()에서 UpdateData()로 transform과 Getmaterial() 데이터 업데이트 해주고 그림


 - 자 이렇게 빌드 해보면 파란 구가 생긴다. 
  - 컬백이래서 구 안쪾으로 카메라 들어가면 구가 사라짐. 토폴로지 방향이 다 반시계가 되버리기 때문.
    원래 컬백 쓰는 이유가 구의 뒷면은 어차피 보이지도 않는거 불필요하게 그거 렌더링하는 자원낭비를 피하려고 해서 컬백설정을 한건데
    문제는 스카이박스는 항상 내부를 볼거기 때문에
    스카이 박스는 항상 컬링프론트로 설정해야된다는 것이다.
    오히려 앞면을 안그리고 뒷면을 그려야한다는 뜻.
    반시계를 그리고 시계방향을 안그림.

    그래서 컬링프론트 설정으로 해줍니다.

 - 이제 스카이 박스에 텍스처를 씌워주자.
  - SetSphereTexture(), SetCubeTexture()함수 생성.
   - UpdateData() 함수에서
     if문으로 텍스처가 세팅되어있다면 GetMaterial()->SetTexParam()함수 호출.
   - 이때 TEX_PARAM:: 설정에서 큐브만 TEXCUBE 라는 슬롯에 따로 설정하는데 나중에 설명할게요 스피어는 원래 우리가 자주쓰던 슬롯에 넣구요

  - 레벨에 스카이박스에 텍스처 설정 해줍시다.
   - 텍스처 세팅할때 "Find() 말고 Load()를 써야되네 tempLevel이 에셋매니저보다 먼저 호출되나보다"


 
 - 지금 카메라가 이동하면 스카이박스 텍스처도 휙휙 움직여서 멀리잇다는 느낌이 안듭니다.
   당연히 내가 스카이박스에 다가가도 도달하지도 못해야겠죠? 담시간에 이런 고민을 해결해보죠



193
=============================================================================================







194